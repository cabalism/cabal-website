<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="Cabal">
<meta name="description" content="Build Haskell applications and libraries">

    <title>Cabal-3.6.1.0</title>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/popper.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/app.css" />
    <link href="../images/Cabal-tiny.png" rel="icon">

</head>

<body>
    <div class="d-lg-none">
        <div id="nav-top" class="d-print-none">
            <nav>
    <ul class="nav">
        <li class="nav-item"><a class="nav-link" href="../">~/</a></li>
        <li class="nav-item"><a class="nav-link" href="http://cabal.readthedocs.io/en/latest/" target="_blank">docs</a></li>
        <li class="nav-item"><a class="nav-link" href="../pages/download.html">download</a></li>
        <li class="nav-item"><a class="nav-link" href="../releases/">releases</a></li>
        <li class="nav-item"><a class="nav-link" href="../pages/faq.html">FAQ</a></li>
        <li class="nav-item"><a class="nav-link" href="../blog/">blog</a></li>
        <li class="nav-item"><a class="nav-link" href="../pages/history.html">history</a></li>
    </ul>
</nav>

        </div>
        <div id="content" class="d-print-col-12">
            <article>
    <section class="header">
    <h2 class="display-4">Cabal-3.6.1.0</h1>
    
    
    
</section>

    <hr>
    <section>
        <h2 id="cabal-3.6.1.0-changelog">Cabal 3.6.1.0 Changelog</h2>
<h3 id="significant-changes">Significant Changes</h3>
<ul>
<li><p>Include cmm-sources when linking shared objects <a href="https://github.com/haskell/cabal/issues/7182">#7182</a> <a href="https://github.com/haskell/cabal/pull/7252">#7252</a></p>
<ul>
<li>Previously <code>cmm-sources</code> were not included in the final link when building a library as a shared object. Fix this.</li>
</ul></li>
<li><p>Prefer canonicalized path when guessing tools from GHC path <a href="https://github.com/haskell/cabal/issues/7390">#7390</a> <a href="https://github.com/haskell/cabal/pull/7392">#7392</a></p>
<p>Motivation</p>
<p>Often times, the user facing <code>ghc</code> binary is
symlinked by other forces, such as the package manager,
tooling like ghcup etc. As such, the naming convention
(version suffix in particular) may not align with the
assumptions made in Cabal and it may find an incorrect ghc-pkg.</p>
<p>See:</p>
<ul>
<li>https://github.com/haskell/cabal/issues/7390</li>
<li>https://gitlab.haskell.org/ghc/ghc/-/issues/18807</li>
<li>https://gitlab.haskell.org/haskell/ghcup-hs/-/issues/73</li>
</ul>
<p>Solution</p>
<p>Guessing the ghc-pkg path is already a hack and will be solved
more appropriately in the future, see</p>
<ul>
<li>https://gitlab.haskell.org/ghc/ghc/-/merge_requests/4214</li>
<li>https://gitlab.haskell.org/ghc/ghc/-/snippets/2710
These patches will solve the issue for future GHC versions.</li>
</ul>
<p>As such, this patch provides a workaround for
older, already existing GHC versions by first always
following the symbolic link of the ghc binary (if it is one)
and preferring its target directory as the guess lookup
location.</p>
<p>Rationale</p>
<p>The canonicalized path of the ghc binary usually points to the
bin/ directory unpacked from a bindist, which is less likely to be
tampered with by distributions and tools. As such, preferring the
canonicalized path should get us more robust results.</p></li>
<li><p>Fix <code>cabal test --enable-library-coverage</code> for other-modules <a href="https://github.com/haskell/cabal/issues/5213">#5213</a> <a href="https://github.com/haskell/cabal/pull/7493">#7493</a></p>
<ul>
<li>Fix <code>cabal test --enable-library-coverage</code> for libraries with nonempty other-modules field.</li>
<li>Due to a hack, this breaks coverage whenever the used Haskell compiler is called 't' (for a non-hacky fix we should rework HPC directories, possibly enabling multilib in the process, see #6440 and #6397).</li>
</ul></li>
<li><p>Set PATH_SEPARATOR=";" when calling ./configure on Windows; this fix is necessary for autoconf &gt;= 2.70 <a href="https://github.com/haskell/cabal/issues/7494">#7494</a> <a href="https://github.com/haskell/cabal/pull/7510">#7510</a></p></li>
<li><p>lazily decode cache files for checking invalidation <a href="https://github.com/haskell/cabal/pull/7516">#7516</a> <a href="https://github.com/haskell/cabal/issues/7466">#7466</a></p>
<ul>
<li>This yields a significant 15% speedup on rebuilding build plans for projects with lots of individual cabal packages.</li>
<li>It exports the <a href="https://github.com/haskell/cabal/blob/899dd34bc48bbaa43da9a4b2fc354c24fd814d05/Cabal/src/Distribution/Utils/Structured.hs#L67">Tag data type</a>, needed by <code>cabal-install &gt;= 3.6.0.0</code>.</li>
</ul></li>
<li><p>defer build-tools-depends choices as well as setup choices <a href="https://github.com/haskell/cabal/pull/7561">#7561</a> <a href="https://github.com/haskell/cabal/issues/7472">#7472</a></p>
<ul>
<li>extends the existing solver pass that defers solving setup depends until top-level goals are solved to also defer build-tool-depends goals until top level goals are solved.</li>
<li>constraints at the top level (on versions, flags, stanzas, etc) are applied first and only then are attempts made to build the less-constrained qualified goals, significantly streamlining the production of valid build plans.</li>
</ul></li>
<li><p>Set -Wno-prepositive-qualified-module in Paths_*.hs <a href="https://github.com/haskell/cabal/pull/7352">#7352</a></p></li>
</ul>
    </section>
</article>

            <hr />
            <footer>
                <div class="row">
    <div class="col-6">
        <i class="fab fa-github"></i>
        <a href="https://github.com/haskell/cabal" target="_blank" rel="noopener">github/haskell/cabal</a>
    </div>
    <div class="col-6">
        <img style="position:relative;top:-2px" src="https://hackage.haskell.org/static/favicon.png" width="14px" height="14px" />
        <a href="https://hackage.haskell.org/" target="_blank" rel="noopener">hackage</a><br />
    </div>
</div>

            </footer>
        </div>
    </div>
    <div class="d-none d-lg-block">
        <div class="fluid-container">
            <div class="row">
                <div id="nav-side" class="col-2 card d-print-none">
                    <div class="card-body">
    <h1 class="card-title" title="Cabal"><a href="../"><img id="img-logo" src="../images/Cabal-light.png" style="width:80%"></a></h1>

    <nav>
        <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link" href="http://cabal.readthedocs.io/en/latest/" target="_blank">
                    <i class="fa fa-book"></i>
                    docs</a></li>
            <li class="nav-item"><a class="nav-link" href="../pages/download.html">
                    <i class="fa fa-download"></i>
                    download</a></li>
            <li class="nav-item"><a class="nav-link" href="../releases/">
                    <i class="fa fa-calendar"></i>
                    releases</a></li>
            <li class="nav-item"><a class="nav-link" href="../pages/faq.html">
                    <i class="fa fa-question-circle"></i>
                    FAQ</a></li>
            <li class="nav-item"><a class="nav-link" href="../blog/">
                    <i class="fa fa-pen-nib"></i>
                    blog</a></li>
            <li class="nav-item"><a class="nav-link" href="../pages/history.html">
                    <i class="fa fa-clock-rotate-left"></i>
                    history</a></li>
        </ul>
    </nav>
    <div class="card">
        <div class="card-body">
            <span id="color-switch">set color&nbsp;<a class="link" id="btn-switch-color-mode">light</a></span>
        </div>
    </div>
</div>

                </div>
                <div id="content" class="d-print-col-12">
                    <article>
    <section class="header">
    <h2 class="display-4">Cabal-3.6.1.0</h1>
    
    
    
</section>

    <hr>
    <section>
        <h2 id="cabal-3.6.1.0-changelog">Cabal 3.6.1.0 Changelog</h2>
<h3 id="significant-changes">Significant Changes</h3>
<ul>
<li><p>Include cmm-sources when linking shared objects <a href="https://github.com/haskell/cabal/issues/7182">#7182</a> <a href="https://github.com/haskell/cabal/pull/7252">#7252</a></p>
<ul>
<li>Previously <code>cmm-sources</code> were not included in the final link when building a library as a shared object. Fix this.</li>
</ul></li>
<li><p>Prefer canonicalized path when guessing tools from GHC path <a href="https://github.com/haskell/cabal/issues/7390">#7390</a> <a href="https://github.com/haskell/cabal/pull/7392">#7392</a></p>
<p>Motivation</p>
<p>Often times, the user facing <code>ghc</code> binary is
symlinked by other forces, such as the package manager,
tooling like ghcup etc. As such, the naming convention
(version suffix in particular) may not align with the
assumptions made in Cabal and it may find an incorrect ghc-pkg.</p>
<p>See:</p>
<ul>
<li>https://github.com/haskell/cabal/issues/7390</li>
<li>https://gitlab.haskell.org/ghc/ghc/-/issues/18807</li>
<li>https://gitlab.haskell.org/haskell/ghcup-hs/-/issues/73</li>
</ul>
<p>Solution</p>
<p>Guessing the ghc-pkg path is already a hack and will be solved
more appropriately in the future, see</p>
<ul>
<li>https://gitlab.haskell.org/ghc/ghc/-/merge_requests/4214</li>
<li>https://gitlab.haskell.org/ghc/ghc/-/snippets/2710
These patches will solve the issue for future GHC versions.</li>
</ul>
<p>As such, this patch provides a workaround for
older, already existing GHC versions by first always
following the symbolic link of the ghc binary (if it is one)
and preferring its target directory as the guess lookup
location.</p>
<p>Rationale</p>
<p>The canonicalized path of the ghc binary usually points to the
bin/ directory unpacked from a bindist, which is less likely to be
tampered with by distributions and tools. As such, preferring the
canonicalized path should get us more robust results.</p></li>
<li><p>Fix <code>cabal test --enable-library-coverage</code> for other-modules <a href="https://github.com/haskell/cabal/issues/5213">#5213</a> <a href="https://github.com/haskell/cabal/pull/7493">#7493</a></p>
<ul>
<li>Fix <code>cabal test --enable-library-coverage</code> for libraries with nonempty other-modules field.</li>
<li>Due to a hack, this breaks coverage whenever the used Haskell compiler is called 't' (for a non-hacky fix we should rework HPC directories, possibly enabling multilib in the process, see #6440 and #6397).</li>
</ul></li>
<li><p>Set PATH_SEPARATOR=";" when calling ./configure on Windows; this fix is necessary for autoconf &gt;= 2.70 <a href="https://github.com/haskell/cabal/issues/7494">#7494</a> <a href="https://github.com/haskell/cabal/pull/7510">#7510</a></p></li>
<li><p>lazily decode cache files for checking invalidation <a href="https://github.com/haskell/cabal/pull/7516">#7516</a> <a href="https://github.com/haskell/cabal/issues/7466">#7466</a></p>
<ul>
<li>This yields a significant 15% speedup on rebuilding build plans for projects with lots of individual cabal packages.</li>
<li>It exports the <a href="https://github.com/haskell/cabal/blob/899dd34bc48bbaa43da9a4b2fc354c24fd814d05/Cabal/src/Distribution/Utils/Structured.hs#L67">Tag data type</a>, needed by <code>cabal-install &gt;= 3.6.0.0</code>.</li>
</ul></li>
<li><p>defer build-tools-depends choices as well as setup choices <a href="https://github.com/haskell/cabal/pull/7561">#7561</a> <a href="https://github.com/haskell/cabal/issues/7472">#7472</a></p>
<ul>
<li>extends the existing solver pass that defers solving setup depends until top-level goals are solved to also defer build-tool-depends goals until top level goals are solved.</li>
<li>constraints at the top level (on versions, flags, stanzas, etc) are applied first and only then are attempts made to build the less-constrained qualified goals, significantly streamlining the production of valid build plans.</li>
</ul></li>
<li><p>Set -Wno-prepositive-qualified-module in Paths_*.hs <a href="https://github.com/haskell/cabal/pull/7352">#7352</a></p></li>
</ul>
    </section>
</article>

                    <hr />
                    <footer>
                        <div class="row">
    <div class="col-6">
        <i class="fab fa-github"></i>
        <a href="https://github.com/haskell/cabal" target="_blank" rel="noopener">github/haskell/cabal</a>
    </div>
    <div class="col-6">
        <img style="position:relative;top:-2px" src="https://hackage.haskell.org/static/favicon.png" width="14px" height="14px" />
        <a href="https://hackage.haskell.org/" target="_blank" rel="noopener">hackage</a><br />
    </div>
</div>

                    </footer>
                </div>
            </div>
        </div>
    </div>
    <script>
        var switchColor = () => {
            if (document.documentElement.getAttribute('data-bs-theme') == 'dark') {
                document.getElementById('btn-switch-color-mode').innerHTML = 'light'
                document.getElementById('img-logo').setAttribute('src','/images/Cabal-dark.png')
            }
            else {
                document.getElementById('btn-switch-color-mode').innerHTML = 'dark'
                document.getElementById('img-logo').setAttribute('src','/images/Cabal-light.png')
            }
        };

        document.getElementById('btn-switch-color-mode').addEventListener('click',()=>{
            if (document.documentElement.getAttribute('data-bs-theme') == 'dark') {
                document.documentElement.setAttribute('data-bs-theme','light')
            }
            else {
                document.documentElement.setAttribute('data-bs-theme','dark')
            }

            switchColor();
        })

        switchColor();
    </script>
</body>

</html>
