<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="Cabal">
<meta name="description" content="Build Haskell applications and libraries">

    <title>cabal-install-3.8.1.0</title>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/popper.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/app.css" />
    <link href="../images/Cabal-tiny.png" rel="icon">

</head>

<body>
    <div class="d-lg-none">
        <div id="nav-top" class="d-print-none">
            <nav>
    <ul class="nav">
        <li class="nav-item"><a class="nav-link" href="../">~/</a></li>
        <li class="nav-item"><a class="nav-link" href="http://cabal.readthedocs.io/en/latest/" target="_blank">docs</a></li>
        <li class="nav-item"><a class="nav-link" href="../pages/download.html">download</a></li>
        <li class="nav-item"><a class="nav-link" href="../releases/">releases</a></li>
        <li class="nav-item"><a class="nav-link" href="../pages/faq.html">FAQ</a></li>
        <li class="nav-item"><a class="nav-link" href="../blog/">blog</a></li>
        <li class="nav-item"><a class="nav-link" href="../pages/history.html">history</a></li>
    </ul>
</nav>

        </div>
        <div id="content" class="d-print-col-12">
            <article>
    <section class="header">
    <h2 class="display-4">cabal-install-3.8.1.0</h1>
    
    
    
</section>

    <hr>
    <section>
        <h2 id="cabal-install-3.8.1.0-changelog">cabal-install 3.8.1.0 Changelog</h2>
<h3 id="significant-changes">Significant changes</h3>
<ul>
<li><p><code>Cabal-3.8.1.0</code> is used, which brings <a href="./Cabal-3.8.1.0.md">its own set of changes</a>,
many of which are significant.</p></li>
<li><p>Expose <code>cabal-install</code> as library <a href="https://github.com/haskell/cabal/issues/1597">#1597</a> <a href="https://github.com/haskell/cabal/issues/3781">#3781</a> <a href="https://github.com/haskell/cabal/issues/4798">#4798</a> <a href="https://github.com/haskell/cabal/issues/6090">#6090</a> <a href="https://github.com/haskell/cabal/issues/7224">#7224</a> <a href="https://github.com/haskell/cabal/pull/7358">#7358</a></p></li>
<li><p>Split out package <code>cabal-install-solver</code></p></li>
<li><p><code>cabal init</code> rewrite <a href="https://github.com/haskell/cabal/issues/1074">#1074</a> <a href="https://github.com/haskell/cabal/issues/6758">#6758</a> <a href="https://github.com/haskell/cabal/issues/6864">#6864</a> <a href="https://github.com/haskell/cabal/issues/7251">#7251</a> <a href="https://github.com/haskell/cabal/issues/7255">#7255</a> <a href="https://github.com/haskell/cabal/issues/7256">#7256</a> <a href="https://github.com/haskell/cabal/issues/7273">#7273</a></p>
<ul>
<li><p>Restructures the <code>cabal init</code> command to fix historical
issues. All flags are preserved.</p>
<ul>
<li>Codebases for interactive and non-interactive flags
are disentangled.</li>
<li>Data structures now exploit relevant stanza structure
and formatters only care about stanza data.</li>
<li>Heuristics and prompts have a pure and impure implementation.</li>
</ul></li>
<li><p>Sets default behavior to be <code>--interactive</code> as opposed to
<code>--non-interactive</code>.</p></li>
<li><p>Rewrites tests to achieve 98% coverage</p>
<ul>
<li>Golden files now test every stanza individually.</li>
<li>Every flag is covered by a unit test.</li>
<li>Interactive, simple, and non-interactive workflows are
covered.</li>
</ul></li>
</ul></li>
<li><p>Conditionals and imports in <code>cabal.project</code> files <a href="https://github.com/haskell/cabal/issues/7556">#7556</a> <a href="https://github.com/haskell/cabal/pull/7783">#7783</a></p>
<p><code>cabal.project</code> files now allow conditional logic on compiler version, arch, etc. as well as imports of other local or remote project of freeze files (both old and new style).</p></li>
<li><p>Changes to <code>cabal v2-configure</code> <a href="https://github.com/haskell/cabal/issues/5591">#5591</a> <a href="https://github.com/haskell/cabal/issues/7180">#7180</a> <a href="https://github.com/haskell/cabal/issues/7405">#7405</a> <a href="https://github.com/haskell/cabal/pull/7402">#7402</a></p>
<ul>
<li>removes the <code>--dry-run</code> part of the <code>v2-configure</code> command. now the command only generates a cabal.project.local. to get the old functionality back, run <code>cabal v2-build --dry-run</code> after (or instead of, if generating cabal.project.local is not needed) <code>v2-configure</code></li>
<li>add <code>--enable-append</code> and <code>--disable-append</code> flags to <code>v2-configure</code>, which toggle the option for the new configuration to be appended to the old config file</li>
<li>add <code>--enable-backup</code> and <code>--disable-backup</code> flags to <code>v2-configure</code>, which toggle the backup feature for the configuration file</li>
</ul></li>
<li><p>Better support for scripts <a href="https://github.com/haskell/cabal/issues/5508">#5508</a> <a href="https://github.com/haskell/cabal/issues/5698">#5698</a> <a href="https://github.com/haskell/cabal/issues/6149">#6149</a> <a href="https://github.com/haskell/cabal/issues/6354">#6354</a> <a href="https://github.com/haskell/cabal/issues/7073">#7073</a> <a href="https://github.com/haskell/cabal/issues/7842">#7842</a> <a href="https://github.com/haskell/cabal/pull/7851">#7851</a> <a href="https://github.com/haskell/cabal/pull/7925">#7925</a> <a href="https://github.com/haskell/cabal/pull/7938">#7938</a> <a href="https://github.com/haskell/cabal/pull/7990">#7990</a> <a href="https://github.com/haskell/cabal/pull/7997">#7997</a></p>
<ul>
<li>Script support improved or added across relevant commands.</li>
<li><code>cabal run script</code> will now cache results and will not do a fresh build every time.</li>
<li><code>cabal build script</code> added: It will build the cache for script.</li>
<li><code>cabal repl script</code> added: It will open a repl for script using the cache if available.</li>
<li><code>cabal clean script</code> added: It will clean the cache for script.</li>
<li><code>cabal clean</code> will now remove script caches for which there is no marching script.</li>
<li><code>cabal list-bin</code> now works with scripts</li>
<li>The name of the generated script executable has been changed from “script” to
“cabal-script-<your-sanitized-script-name>” for easier process management.</li>
<li>Reduce the default verbosity of scripts, so that the build output doesn’t interfere with the script output.</li>
<li>Scripts now support a project metadata block that allows them to use options
that would normally be set in a cabal.project file.</li>
</ul></li>
<li><p><code>cabal-install-solver</code>: Backtrack when no pkg-config is present <a href="https://github.com/haskell/cabal/issues/7448">#7448</a> <a href="https://github.com/haskell/cabal/pull/7621">#7621</a></p>
<p>When solving for pkgconfig-depends, when pkg-config is not present, the cabal solver will now backtrack and try a different automatic flag and dependency configuration, just as it does if pkg-config is present, but does not contain the specified package.</p></li>
<li><p>Apply local options only to local packages <a href="https://github.com/haskell/cabal/issues/7998">#7998</a> <a href="https://github.com/haskell/cabal/pull/7973">#7973</a></p>
<ul>
<li>Command-line <code>ghc-options</code> only applies to local packages</li>
<li><code>program-options</code> stanza only applies to local packages</li>
</ul></li>
<li><p>Add <code>--open</code> flag to <code>cabal haddock</code> <a href="https://github.com/haskell/cabal/issues/7366">#7366</a> <a href="https://github.com/haskell/cabal/pull/7550">#7550</a></p></li>
</ul>
<h3 id="other-changes">Other changes</h3>
<ul>
<li><p>Remove <code>world</code> file functionality <a href="https://github.com/haskell/cabal/issues/6767">#6767</a> <a href="https://github.com/haskell/cabal/pull/7746">#7746</a></p>
<p>In <code>v1-install</code>, <code>world</code> was used to trace what packages have been
installed, and re-install everything that is listed in it on-demand. However, in
<code>v2-install</code>, this is no longer needed, and outdated.
Additionally, <code>world</code> code-path is probably not up-to-date, remove it instead of
having partial features.</p>
<ul>
<li><p>Don’t generate <code>world</code> file in <code>~/.cabal</code> when <code>v1-install</code> is executed.</p></li>
<li><p>Don’t ever read <code>world</code> from <code>~/.cabal</code>.</p></li>
<li><p>Remove meta-target <code>world</code> from <code>v1-install</code>.</p></li>
</ul></li>
<li><p>A default configuration is no longer written when a config file is given explicitly <a href="https://github.com/haskell/cabal/issues/7705">#7705</a> <a href="https://github.com/haskell/cabal/pull/7715">#7715</a></p>
<ul>
<li><p>When no config file exists, <code>cabal</code> commands will create a default one.</p></li>
<li><p>This behavior is discontinued now when the config file is given explicitly
via the <code>--config-file</code> option or the <code>CABAL_CONFIG</code> environment variable.</p></li>
<li><p>If no config file is given explicitly, and the default config file
(relative to <code>CABAL_DIR</code>) does not exist, it is created as it used to be.</p></li>
</ul></li>
<li><p>Use <code>nroff -man | less</code> instead of <code>man</code> as backend for <code>cabal man</code> <a href="https://github.com/haskell/cabal/issues/7714">#7714</a> <a href="https://github.com/haskell/cabal/pull/7726">#7726</a></p>
<p>The previous implementation of <code>cabal man</code> used <code>man</code> as backend to
view the generated manpage file. However, macOS’ and BSD’s <code>man</code> does
not accept a file as input, so <code>cabal man</code> was broken on macOS and
BSD.</p>
<p>The issue has been fixed by piping the generated manpage through
<code>nroff -man</code> and then into <code>$PAGER</code> which defaults to <code>less</code>. Thus,
<code>cabal man</code> now works both on Linux and macOS/BSD.</p>
<p>NB: <code>cabal man</code> requires <code>nroff</code> to be installed which is the case for
standard setups (but may not be case on slim setups like VMs used in
CI). Note that <code>nroff</code> is not necessarily a prerequisite of a package
containing <code>man</code>.</p></li>
<li><p>Use <code>Win32 &gt;= 2.8</code> to get <code>Win32.sYNCHRONIZE</code> <a href="https://github.com/haskell/cabal/issues/7835">#7835</a> <a href="https://github.com/haskell/cabal/pull/7982">#7982</a></p>
<p>#7982 also completes a changelog entry for <code>Cabal-3.6.1.0</code>, noting it is required for <code>cabal-install &gt;= 3.6</code>.</p></li>
<li><p>Add <code>preferred-versions</code> support for <code>LocalIndexRepo</code> <a href="https://github.com/haskell/cabal/issues/7294">#7294</a> <a href="https://github.com/haskell/cabal/pull/7295">#7295</a></p>
<ul>
<li>Previously, the only repo-index-type that reads the preferred-versions file was <code>RepoRemote</code>.
<code>LocalIndexRepo</code> now also supports parsing <code>preferred-versions</code> file, main purpose is to write tests.
As a nice side-effect, users can provide their own overlay over package sets to restrict or prefer certain package versions.</li>
</ul></li>
<li><p>Add <code>preferred-versions</code> support for <code>cabal outdated</code> <a href="https://github.com/haskell/cabal/issues/5603">#5603</a> <a href="https://github.com/haskell/cabal/issues/7249">#7249</a> <a href="https://github.com/haskell/cabal/pull/7296">#7296</a></p>
<ul>
<li><code>cabal outdated</code> honours the <code>preferred-versions</code> file which might deprecate or prefer certain
versions of packages. In particular, if the only newer version of a package has been deprecated,
<code>cabal outdated</code> should not report that there are newer versions available.</li>
</ul></li>
<li><p>Standalone tests for <code>cabal init</code> <a href="https://github.com/haskell/cabal/issues/7410">#7410</a> <a href="https://github.com/haskell/cabal/pull/7424">#7424</a></p>
<ul>
<li>change the behaviour of the <code>--tests</code> flag for <code>cabal init</code>,
see https://github.com/haskell/cabal/issues/7410#issuecomment-849913926</li>
<li>add a new value <code>TestSuite</code> for the <code>PackageType</code> type</li>
</ul></li>
<li><p><code>cabal outdated --v2-freeze-file</code> prints error message if no freeze file can be found <a href="https://github.com/haskell/cabal/issues/7406">#7406</a> <a href="https://github.com/haskell/cabal/pull/7440">#7440</a></p>
<p>Instead of ignoring a missing <code>.freeze</code> file, abort execution and print an error message.</p></li>
<li><p>Make <code>cabal</code> respect <code>setgid</code> permission bit when creating directories <a href="https://github.com/haskell/cabal/issues/7560">#7560</a> <a href="https://github.com/haskell/cabal/pull/7572">#7572</a></p>
<ul>
<li>Previously <code>cabal</code> would override an admin’s choice to use setgid on the
<code>.cabal</code> directory by using hardcoded file and directory modes upon
creation. Instead we now take what the system decides and only add to
that set of permissions.</li>
</ul></li>
<li><p>Glob expand <code>extra-source-files</code> when tracking for rebuild <a href="https://github.com/haskell/cabal/issues/4746">#4746</a> <a href="https://github.com/haskell/cabal/pull/7608">#7608</a></p>
<ul>
<li>Since 3.4, <code>extra-source-files</code> have been tracked by cabal-install in the rebuild-checking logic. However, this tracking did not, until this PR, take into account glob-expansion.</li>
</ul></li>
<li><p>Improve error message when no test/benchmark is found <a href="https://github.com/haskell/cabal/issues/5079">#5079</a> <a href="https://github.com/haskell/cabal/issues/5255">#5255</a> <a href="https://github.com/haskell/cabal/pull/7834">#7834</a></p>
<p>When <code>cabal test</code> and the error message recommends setting <code>tests: True</code>, the next <code>cabal test</code> run is likely to fail with a solver error. The user might incorrectly conclude that setting <code>tests: True</code> made the problem worse, because the failure now occurs earlier (at solving time rather than at testing time).</p>
<p>By including the fact that a plan failure is expected in the error message, hopefully users will be more confident that setting <code>tests: True</code> was the right move, so they will be able to focus on the true cause of the problem: the fact that no plan including the tests exists.</p></li>
<li><p>Remove <code>Distribution.Client.Compat.FilePerms</code> <a href="https://github.com/haskell/cabal/pull/7948">#7948</a></p>
<ul>
<li>Remove the module <code>Distribution.Client.Compat.FilePerms</code>, since it’s
both dead code and duplicates code from <code>Distribution.Compat.CopyFile</code>.</li>
</ul></li>
<li><p>Avoid malformed range requests <a href="https://github.com/haskell/cabal/issues/5952">#5952</a> <a href="https://github.com/haskell/cabal/pull/7970">#7970</a></p>
<ul>
<li>Don’t send malformed range requests. Should make fetching from head.hackage and other “unstable” overlays more reliable.</li>
</ul></li>
<li><p>Improve error message for empty <code>--allow-newer=</code> <a href="https://github.com/haskell/cabal/issues/7740">#7740</a> <a href="https://github.com/haskell/cabal/pull/8140">#8140</a></p>
<p>Instead of internal error, the message now explains that empty argument for
<code>--allow-newer=</code> is not allowed and reminds what <code>--allow-newer</code> (with the empty
argument) means.</p></li>
<li><p><code>cabal check</code> now fails when no upper bounds for <code>base</code> or <code>Cabal</code> are present in setup dependencies <a href="https://github.com/haskell/cabal/issues/4683">#4683</a> <a href="https://github.com/haskell/cabal/pull/5370">#5370</a> <a href="https://github.com/haskell/cabal/pull/7409">#7409</a></p></li>
<li><p>Fix <code>v2-haddock</code> results in “unexpected status” <a href="https://github.com/haskell/cabal/issues/6679">#6679</a> <a href="https://github.com/haskell/cabal/pull/7843">#7843</a></p></li>
<li><p>Fix that cabal v2 commands (<code>install</code>, <code>repl</code>, <code>run</code>) use duplicate global config and rebuild libs twice in the store <a href="https://github.com/haskell/cabal/issues/6907">#6907</a> <a href="https://github.com/haskell/cabal/pull/7753">#7753</a> <a href="https://github.com/haskell/cabal/pull/7759">#7759</a></p></li>
<li><p><code>--repl-no-load</code> option skips startup modules load in REPL <a href="https://github.com/haskell/cabal/issues/7541">#7541</a> <a href="https://github.com/haskell/cabal/pull/7578">#7578</a></p></li>
<li><p>Fix post-checkout-command crash when 0 exit status bug <a href="https://github.com/haskell/cabal/issues/7641">#7641</a> <a href="https://github.com/haskell/cabal/pull/7847">#7847</a></p></li>
<li><p>Fix <code>list-bin</code> to only choose the selected component <a href="https://github.com/haskell/cabal/issues/7679">#7679</a> <a href="https://github.com/haskell/cabal/pull/7791">#7791</a></p></li>
<li><p><code>cabal sdist</code> works in projects with <code>extra-packages</code> <a href="https://github.com/haskell/cabal/issues/7698">#7698</a></p></li>
<li><p>Add <code>-c</code> alias for <code>--constraint</code> command line flag <a href="https://github.com/haskell/cabal/issues/7765">#7765</a> <a href="https://github.com/haskell/cabal/pull/7766">#7766</a></p></li>
<li><p>Ensure that <code>v2-sdist</code> command respects the <code>--ignore-project</code> flag <a href="https://github.com/haskell/cabal/issues/7965">#7965</a> <a href="https://github.com/haskell/cabal/pull/8109">#8109</a></p></li>
<li><p>Make enable/disable nix flags easier to read <a href="https://github.com/haskell/cabal/issues/8036">#8036</a> <a href="https://github.com/haskell/cabal/pull/8054">#8054</a></p></li>
<li><p>Add “prompt” strategy when symlinking binaries. <a href="https://github.com/haskell/cabal/pull/5672">#5672</a></p></li>
<li><p>Add a verbosity flag <code>+nowarn</code>, to suppress all warnings <a href="https://github.com/haskell/cabal/issues/7286">#7286</a> <a href="https://github.com/haskell/cabal/pull/7470">#7470</a></p></li>
<li><p>Lazily decode cache files for checking invalidation <a href="https://github.com/haskell/cabal/issues/7466">#7466</a> <a href="https://github.com/haskell/cabal/pull/7516">#7516</a></p></li>
<li><p>Defer <code>build-tools-depends</code> choices as well as setup choices <a href="https://github.com/haskell/cabal/pull/7532">#7532</a> <a href="https://github.com/haskell/cabal/pull/7561">#7561</a></p></li>
<li><p>Fix running GHCJS executables <a href="https://github.com/haskell/cabal/issues/6175">#6175</a> <a href="https://github.com/haskell/cabal/issues/6361">#6361</a> <a href="https://github.com/haskell/cabal/pull/7575">#7575</a></p></li>
<li><p>Support Git submodules in <code>source-package-repository</code> <a href="https://github.com/haskell/cabal/issues/5536">#5536</a> <a href="https://github.com/haskell/cabal/pull/7625">#7625</a></p></li>
<li><p>Add support for <code>--package-db</code> flags to v2 commands <a href="https://github.com/haskell/cabal/issues/5773">#5773</a> <a href="https://github.com/haskell/cabal/pull/7676">#7676</a></p></li>
<li><p><code>cabal init</code> now takes an optional argument and treats it as root directory for the new package <a href="https://github.com/haskell/cabal/issues/7871">#7871</a> <a href="https://github.com/haskell/cabal/pull/7873">#7873</a></p></li>
<li><p>Silence warning about <code>world</code>-file field being unrecognised for flat config files <a href="https://github.com/haskell/cabal/issues/7894">#7894</a> <a href="https://github.com/haskell/cabal/pull/7903">#7903</a></p></li>
<li><p>Fix Ctrl-C handling during package download <a href="https://github.com/haskell/cabal/issues/6322">#6322</a> <a href="https://github.com/haskell/cabal/pull/7929">#7929</a></p></li>
<li><p>Fix the timestamp shown during <code>cabal update</code> <a href="https://github.com/haskell/cabal/pull/7934">#7934</a></p></li>
<li><p>Sync darcs repos <a href="https://github.com/haskell/cabal/pull/7137">#7137</a></p></li>
<li><p><code>cabal-install-solver</code>: Provide more context in error messages <a href="https://github.com/haskell/cabal/issues/7468">#7468</a> <a href="https://github.com/haskell/cabal/pull/7473">#7473</a></p>
<ul>
<li>Error messages for misspelled extensions and languages now provide additional context.</li>
<li>The error messages will provide a suggested fix if the misspelled extension or language is similar enough
to known languages and extensions.</li>
</ul></li>
<li><p>cabal init -i should autodetect author name and maintainer email (fix #8255) <a href="https://github.com/haskell/cabal/issues/8255">#8255</a> <a href="https://github.com/haskell/cabal/pull/8267">#8267</a></p></li>
<li><p>cabal init -i: add the GHC2021 language option <a href="https://github.com/haskell/cabal/issues/8265">#8265</a> <a href="https://github.com/haskell/cabal/pull/8277">#8277</a></p></li>
<li><p>Automatically pipe auth from repo uris into curl transport. <a href="https://github.com/haskell/cabal/issues/4743">#4743</a> <a href="https://github.com/haskell/cabal/pull/7630">#7630</a></p></li>
<li><p>Build release archives (and validate) with GHC 9.2.3 <a href="https://github.com/haskell/cabal/issues/8271">#8271</a> <a href="https://github.com/haskell/cabal/pull/8272">#8272</a></p>
<ul>
<li>The release binaries are now built with GHC 9.2.3, which fixes some minor snags</li>
</ul></li>
</ul>
<h3 id="internal-changes">Internal changes</h3>
<ul>
<li><p>Remove bootstrapping plan files from version control, and simplify bootstrap update <code>Makefile</code> targets. <a href="https://github.com/haskell/cabal/pull/7949">#7949</a></p></li>
<li><p>CI setup</p>
<ul>
<li>Remove Travis scripts <a href="https://github.com/haskell/cabal/pull/6959">#6959</a></li>
</ul></li>
</ul>
    </section>
</article>

            <hr />
            <footer>
                <div class="row">
    <div class="col-6">
        <i class="fab fa-github"></i>
        <a href="https://github.com/haskell/cabal" target="_blank" rel="noopener">github/haskell/cabal</a>
    </div>
    <div class="col-6">
        <img style="position:relative;top:-2px" src="https://hackage.haskell.org/static/favicon.png" width="14px" height="14px" />
        <a href="https://hackage.haskell.org/" target="_blank" rel="noopener">hackage</a><br />
    </div>
</div>

            </footer>
        </div>
    </div>
    <div class="d-none d-lg-block">
        <div class="fluid-container">
            <div class="row">
                <div id="nav-side" class="col-2 card d-print-none">
                    <div class="card-body">
    <h1 class="card-title" title="Cabal"><a href="../"><img id="img-logo" src="../images/Cabal-light.png" style="width:80%"></a></h1>

    <nav>
        <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link" href="http://cabal.readthedocs.io/en/latest/" target="_blank">
                    <i class="fa fa-book"></i>
                    docs</a></li>
            <li class="nav-item"><a class="nav-link" href="../pages/download.html">
                    <i class="fa fa-download"></i>
                    download</a></li>
            <li class="nav-item"><a class="nav-link" href="../releases/">
                    <i class="fa fa-calendar"></i>
                    releases</a></li>
            <li class="nav-item"><a class="nav-link" href="../pages/faq.html">
                    <i class="fa fa-question-circle"></i>
                    FAQ</a></li>
            <li class="nav-item"><a class="nav-link" href="../blog/">
                    <i class="fa fa-pen-nib"></i>
                    blog</a></li>
            <li class="nav-item"><a class="nav-link" href="../pages/history.html">
                    <i class="fa fa-clock-rotate-left"></i>
                    history</a></li>
        </ul>
    </nav>
    <div class="card">
        <div class="card-body">
            <span id="color-switch">set color&nbsp;<a class="link" id="btn-switch-color-mode">light</a></span>
        </div>
    </div>
</div>

                </div>
                <div id="content" class="d-print-col-12">
                    <article>
    <section class="header">
    <h2 class="display-4">cabal-install-3.8.1.0</h1>
    
    
    
</section>

    <hr>
    <section>
        <h2 id="cabal-install-3.8.1.0-changelog">cabal-install 3.8.1.0 Changelog</h2>
<h3 id="significant-changes">Significant changes</h3>
<ul>
<li><p><code>Cabal-3.8.1.0</code> is used, which brings <a href="./Cabal-3.8.1.0.md">its own set of changes</a>,
many of which are significant.</p></li>
<li><p>Expose <code>cabal-install</code> as library <a href="https://github.com/haskell/cabal/issues/1597">#1597</a> <a href="https://github.com/haskell/cabal/issues/3781">#3781</a> <a href="https://github.com/haskell/cabal/issues/4798">#4798</a> <a href="https://github.com/haskell/cabal/issues/6090">#6090</a> <a href="https://github.com/haskell/cabal/issues/7224">#7224</a> <a href="https://github.com/haskell/cabal/pull/7358">#7358</a></p></li>
<li><p>Split out package <code>cabal-install-solver</code></p></li>
<li><p><code>cabal init</code> rewrite <a href="https://github.com/haskell/cabal/issues/1074">#1074</a> <a href="https://github.com/haskell/cabal/issues/6758">#6758</a> <a href="https://github.com/haskell/cabal/issues/6864">#6864</a> <a href="https://github.com/haskell/cabal/issues/7251">#7251</a> <a href="https://github.com/haskell/cabal/issues/7255">#7255</a> <a href="https://github.com/haskell/cabal/issues/7256">#7256</a> <a href="https://github.com/haskell/cabal/issues/7273">#7273</a></p>
<ul>
<li><p>Restructures the <code>cabal init</code> command to fix historical
issues. All flags are preserved.</p>
<ul>
<li>Codebases for interactive and non-interactive flags
are disentangled.</li>
<li>Data structures now exploit relevant stanza structure
and formatters only care about stanza data.</li>
<li>Heuristics and prompts have a pure and impure implementation.</li>
</ul></li>
<li><p>Sets default behavior to be <code>--interactive</code> as opposed to
<code>--non-interactive</code>.</p></li>
<li><p>Rewrites tests to achieve 98% coverage</p>
<ul>
<li>Golden files now test every stanza individually.</li>
<li>Every flag is covered by a unit test.</li>
<li>Interactive, simple, and non-interactive workflows are
covered.</li>
</ul></li>
</ul></li>
<li><p>Conditionals and imports in <code>cabal.project</code> files <a href="https://github.com/haskell/cabal/issues/7556">#7556</a> <a href="https://github.com/haskell/cabal/pull/7783">#7783</a></p>
<p><code>cabal.project</code> files now allow conditional logic on compiler version, arch, etc. as well as imports of other local or remote project of freeze files (both old and new style).</p></li>
<li><p>Changes to <code>cabal v2-configure</code> <a href="https://github.com/haskell/cabal/issues/5591">#5591</a> <a href="https://github.com/haskell/cabal/issues/7180">#7180</a> <a href="https://github.com/haskell/cabal/issues/7405">#7405</a> <a href="https://github.com/haskell/cabal/pull/7402">#7402</a></p>
<ul>
<li>removes the <code>--dry-run</code> part of the <code>v2-configure</code> command. now the command only generates a cabal.project.local. to get the old functionality back, run <code>cabal v2-build --dry-run</code> after (or instead of, if generating cabal.project.local is not needed) <code>v2-configure</code></li>
<li>add <code>--enable-append</code> and <code>--disable-append</code> flags to <code>v2-configure</code>, which toggle the option for the new configuration to be appended to the old config file</li>
<li>add <code>--enable-backup</code> and <code>--disable-backup</code> flags to <code>v2-configure</code>, which toggle the backup feature for the configuration file</li>
</ul></li>
<li><p>Better support for scripts <a href="https://github.com/haskell/cabal/issues/5508">#5508</a> <a href="https://github.com/haskell/cabal/issues/5698">#5698</a> <a href="https://github.com/haskell/cabal/issues/6149">#6149</a> <a href="https://github.com/haskell/cabal/issues/6354">#6354</a> <a href="https://github.com/haskell/cabal/issues/7073">#7073</a> <a href="https://github.com/haskell/cabal/issues/7842">#7842</a> <a href="https://github.com/haskell/cabal/pull/7851">#7851</a> <a href="https://github.com/haskell/cabal/pull/7925">#7925</a> <a href="https://github.com/haskell/cabal/pull/7938">#7938</a> <a href="https://github.com/haskell/cabal/pull/7990">#7990</a> <a href="https://github.com/haskell/cabal/pull/7997">#7997</a></p>
<ul>
<li>Script support improved or added across relevant commands.</li>
<li><code>cabal run script</code> will now cache results and will not do a fresh build every time.</li>
<li><code>cabal build script</code> added: It will build the cache for script.</li>
<li><code>cabal repl script</code> added: It will open a repl for script using the cache if available.</li>
<li><code>cabal clean script</code> added: It will clean the cache for script.</li>
<li><code>cabal clean</code> will now remove script caches for which there is no marching script.</li>
<li><code>cabal list-bin</code> now works with scripts</li>
<li>The name of the generated script executable has been changed from “script” to
“cabal-script-<your-sanitized-script-name>” for easier process management.</li>
<li>Reduce the default verbosity of scripts, so that the build output doesn’t interfere with the script output.</li>
<li>Scripts now support a project metadata block that allows them to use options
that would normally be set in a cabal.project file.</li>
</ul></li>
<li><p><code>cabal-install-solver</code>: Backtrack when no pkg-config is present <a href="https://github.com/haskell/cabal/issues/7448">#7448</a> <a href="https://github.com/haskell/cabal/pull/7621">#7621</a></p>
<p>When solving for pkgconfig-depends, when pkg-config is not present, the cabal solver will now backtrack and try a different automatic flag and dependency configuration, just as it does if pkg-config is present, but does not contain the specified package.</p></li>
<li><p>Apply local options only to local packages <a href="https://github.com/haskell/cabal/issues/7998">#7998</a> <a href="https://github.com/haskell/cabal/pull/7973">#7973</a></p>
<ul>
<li>Command-line <code>ghc-options</code> only applies to local packages</li>
<li><code>program-options</code> stanza only applies to local packages</li>
</ul></li>
<li><p>Add <code>--open</code> flag to <code>cabal haddock</code> <a href="https://github.com/haskell/cabal/issues/7366">#7366</a> <a href="https://github.com/haskell/cabal/pull/7550">#7550</a></p></li>
</ul>
<h3 id="other-changes">Other changes</h3>
<ul>
<li><p>Remove <code>world</code> file functionality <a href="https://github.com/haskell/cabal/issues/6767">#6767</a> <a href="https://github.com/haskell/cabal/pull/7746">#7746</a></p>
<p>In <code>v1-install</code>, <code>world</code> was used to trace what packages have been
installed, and re-install everything that is listed in it on-demand. However, in
<code>v2-install</code>, this is no longer needed, and outdated.
Additionally, <code>world</code> code-path is probably not up-to-date, remove it instead of
having partial features.</p>
<ul>
<li><p>Don’t generate <code>world</code> file in <code>~/.cabal</code> when <code>v1-install</code> is executed.</p></li>
<li><p>Don’t ever read <code>world</code> from <code>~/.cabal</code>.</p></li>
<li><p>Remove meta-target <code>world</code> from <code>v1-install</code>.</p></li>
</ul></li>
<li><p>A default configuration is no longer written when a config file is given explicitly <a href="https://github.com/haskell/cabal/issues/7705">#7705</a> <a href="https://github.com/haskell/cabal/pull/7715">#7715</a></p>
<ul>
<li><p>When no config file exists, <code>cabal</code> commands will create a default one.</p></li>
<li><p>This behavior is discontinued now when the config file is given explicitly
via the <code>--config-file</code> option or the <code>CABAL_CONFIG</code> environment variable.</p></li>
<li><p>If no config file is given explicitly, and the default config file
(relative to <code>CABAL_DIR</code>) does not exist, it is created as it used to be.</p></li>
</ul></li>
<li><p>Use <code>nroff -man | less</code> instead of <code>man</code> as backend for <code>cabal man</code> <a href="https://github.com/haskell/cabal/issues/7714">#7714</a> <a href="https://github.com/haskell/cabal/pull/7726">#7726</a></p>
<p>The previous implementation of <code>cabal man</code> used <code>man</code> as backend to
view the generated manpage file. However, macOS’ and BSD’s <code>man</code> does
not accept a file as input, so <code>cabal man</code> was broken on macOS and
BSD.</p>
<p>The issue has been fixed by piping the generated manpage through
<code>nroff -man</code> and then into <code>$PAGER</code> which defaults to <code>less</code>. Thus,
<code>cabal man</code> now works both on Linux and macOS/BSD.</p>
<p>NB: <code>cabal man</code> requires <code>nroff</code> to be installed which is the case for
standard setups (but may not be case on slim setups like VMs used in
CI). Note that <code>nroff</code> is not necessarily a prerequisite of a package
containing <code>man</code>.</p></li>
<li><p>Use <code>Win32 &gt;= 2.8</code> to get <code>Win32.sYNCHRONIZE</code> <a href="https://github.com/haskell/cabal/issues/7835">#7835</a> <a href="https://github.com/haskell/cabal/pull/7982">#7982</a></p>
<p>#7982 also completes a changelog entry for <code>Cabal-3.6.1.0</code>, noting it is required for <code>cabal-install &gt;= 3.6</code>.</p></li>
<li><p>Add <code>preferred-versions</code> support for <code>LocalIndexRepo</code> <a href="https://github.com/haskell/cabal/issues/7294">#7294</a> <a href="https://github.com/haskell/cabal/pull/7295">#7295</a></p>
<ul>
<li>Previously, the only repo-index-type that reads the preferred-versions file was <code>RepoRemote</code>.
<code>LocalIndexRepo</code> now also supports parsing <code>preferred-versions</code> file, main purpose is to write tests.
As a nice side-effect, users can provide their own overlay over package sets to restrict or prefer certain package versions.</li>
</ul></li>
<li><p>Add <code>preferred-versions</code> support for <code>cabal outdated</code> <a href="https://github.com/haskell/cabal/issues/5603">#5603</a> <a href="https://github.com/haskell/cabal/issues/7249">#7249</a> <a href="https://github.com/haskell/cabal/pull/7296">#7296</a></p>
<ul>
<li><code>cabal outdated</code> honours the <code>preferred-versions</code> file which might deprecate or prefer certain
versions of packages. In particular, if the only newer version of a package has been deprecated,
<code>cabal outdated</code> should not report that there are newer versions available.</li>
</ul></li>
<li><p>Standalone tests for <code>cabal init</code> <a href="https://github.com/haskell/cabal/issues/7410">#7410</a> <a href="https://github.com/haskell/cabal/pull/7424">#7424</a></p>
<ul>
<li>change the behaviour of the <code>--tests</code> flag for <code>cabal init</code>,
see https://github.com/haskell/cabal/issues/7410#issuecomment-849913926</li>
<li>add a new value <code>TestSuite</code> for the <code>PackageType</code> type</li>
</ul></li>
<li><p><code>cabal outdated --v2-freeze-file</code> prints error message if no freeze file can be found <a href="https://github.com/haskell/cabal/issues/7406">#7406</a> <a href="https://github.com/haskell/cabal/pull/7440">#7440</a></p>
<p>Instead of ignoring a missing <code>.freeze</code> file, abort execution and print an error message.</p></li>
<li><p>Make <code>cabal</code> respect <code>setgid</code> permission bit when creating directories <a href="https://github.com/haskell/cabal/issues/7560">#7560</a> <a href="https://github.com/haskell/cabal/pull/7572">#7572</a></p>
<ul>
<li>Previously <code>cabal</code> would override an admin’s choice to use setgid on the
<code>.cabal</code> directory by using hardcoded file and directory modes upon
creation. Instead we now take what the system decides and only add to
that set of permissions.</li>
</ul></li>
<li><p>Glob expand <code>extra-source-files</code> when tracking for rebuild <a href="https://github.com/haskell/cabal/issues/4746">#4746</a> <a href="https://github.com/haskell/cabal/pull/7608">#7608</a></p>
<ul>
<li>Since 3.4, <code>extra-source-files</code> have been tracked by cabal-install in the rebuild-checking logic. However, this tracking did not, until this PR, take into account glob-expansion.</li>
</ul></li>
<li><p>Improve error message when no test/benchmark is found <a href="https://github.com/haskell/cabal/issues/5079">#5079</a> <a href="https://github.com/haskell/cabal/issues/5255">#5255</a> <a href="https://github.com/haskell/cabal/pull/7834">#7834</a></p>
<p>When <code>cabal test</code> and the error message recommends setting <code>tests: True</code>, the next <code>cabal test</code> run is likely to fail with a solver error. The user might incorrectly conclude that setting <code>tests: True</code> made the problem worse, because the failure now occurs earlier (at solving time rather than at testing time).</p>
<p>By including the fact that a plan failure is expected in the error message, hopefully users will be more confident that setting <code>tests: True</code> was the right move, so they will be able to focus on the true cause of the problem: the fact that no plan including the tests exists.</p></li>
<li><p>Remove <code>Distribution.Client.Compat.FilePerms</code> <a href="https://github.com/haskell/cabal/pull/7948">#7948</a></p>
<ul>
<li>Remove the module <code>Distribution.Client.Compat.FilePerms</code>, since it’s
both dead code and duplicates code from <code>Distribution.Compat.CopyFile</code>.</li>
</ul></li>
<li><p>Avoid malformed range requests <a href="https://github.com/haskell/cabal/issues/5952">#5952</a> <a href="https://github.com/haskell/cabal/pull/7970">#7970</a></p>
<ul>
<li>Don’t send malformed range requests. Should make fetching from head.hackage and other “unstable” overlays more reliable.</li>
</ul></li>
<li><p>Improve error message for empty <code>--allow-newer=</code> <a href="https://github.com/haskell/cabal/issues/7740">#7740</a> <a href="https://github.com/haskell/cabal/pull/8140">#8140</a></p>
<p>Instead of internal error, the message now explains that empty argument for
<code>--allow-newer=</code> is not allowed and reminds what <code>--allow-newer</code> (with the empty
argument) means.</p></li>
<li><p><code>cabal check</code> now fails when no upper bounds for <code>base</code> or <code>Cabal</code> are present in setup dependencies <a href="https://github.com/haskell/cabal/issues/4683">#4683</a> <a href="https://github.com/haskell/cabal/pull/5370">#5370</a> <a href="https://github.com/haskell/cabal/pull/7409">#7409</a></p></li>
<li><p>Fix <code>v2-haddock</code> results in “unexpected status” <a href="https://github.com/haskell/cabal/issues/6679">#6679</a> <a href="https://github.com/haskell/cabal/pull/7843">#7843</a></p></li>
<li><p>Fix that cabal v2 commands (<code>install</code>, <code>repl</code>, <code>run</code>) use duplicate global config and rebuild libs twice in the store <a href="https://github.com/haskell/cabal/issues/6907">#6907</a> <a href="https://github.com/haskell/cabal/pull/7753">#7753</a> <a href="https://github.com/haskell/cabal/pull/7759">#7759</a></p></li>
<li><p><code>--repl-no-load</code> option skips startup modules load in REPL <a href="https://github.com/haskell/cabal/issues/7541">#7541</a> <a href="https://github.com/haskell/cabal/pull/7578">#7578</a></p></li>
<li><p>Fix post-checkout-command crash when 0 exit status bug <a href="https://github.com/haskell/cabal/issues/7641">#7641</a> <a href="https://github.com/haskell/cabal/pull/7847">#7847</a></p></li>
<li><p>Fix <code>list-bin</code> to only choose the selected component <a href="https://github.com/haskell/cabal/issues/7679">#7679</a> <a href="https://github.com/haskell/cabal/pull/7791">#7791</a></p></li>
<li><p><code>cabal sdist</code> works in projects with <code>extra-packages</code> <a href="https://github.com/haskell/cabal/issues/7698">#7698</a></p></li>
<li><p>Add <code>-c</code> alias for <code>--constraint</code> command line flag <a href="https://github.com/haskell/cabal/issues/7765">#7765</a> <a href="https://github.com/haskell/cabal/pull/7766">#7766</a></p></li>
<li><p>Ensure that <code>v2-sdist</code> command respects the <code>--ignore-project</code> flag <a href="https://github.com/haskell/cabal/issues/7965">#7965</a> <a href="https://github.com/haskell/cabal/pull/8109">#8109</a></p></li>
<li><p>Make enable/disable nix flags easier to read <a href="https://github.com/haskell/cabal/issues/8036">#8036</a> <a href="https://github.com/haskell/cabal/pull/8054">#8054</a></p></li>
<li><p>Add “prompt” strategy when symlinking binaries. <a href="https://github.com/haskell/cabal/pull/5672">#5672</a></p></li>
<li><p>Add a verbosity flag <code>+nowarn</code>, to suppress all warnings <a href="https://github.com/haskell/cabal/issues/7286">#7286</a> <a href="https://github.com/haskell/cabal/pull/7470">#7470</a></p></li>
<li><p>Lazily decode cache files for checking invalidation <a href="https://github.com/haskell/cabal/issues/7466">#7466</a> <a href="https://github.com/haskell/cabal/pull/7516">#7516</a></p></li>
<li><p>Defer <code>build-tools-depends</code> choices as well as setup choices <a href="https://github.com/haskell/cabal/pull/7532">#7532</a> <a href="https://github.com/haskell/cabal/pull/7561">#7561</a></p></li>
<li><p>Fix running GHCJS executables <a href="https://github.com/haskell/cabal/issues/6175">#6175</a> <a href="https://github.com/haskell/cabal/issues/6361">#6361</a> <a href="https://github.com/haskell/cabal/pull/7575">#7575</a></p></li>
<li><p>Support Git submodules in <code>source-package-repository</code> <a href="https://github.com/haskell/cabal/issues/5536">#5536</a> <a href="https://github.com/haskell/cabal/pull/7625">#7625</a></p></li>
<li><p>Add support for <code>--package-db</code> flags to v2 commands <a href="https://github.com/haskell/cabal/issues/5773">#5773</a> <a href="https://github.com/haskell/cabal/pull/7676">#7676</a></p></li>
<li><p><code>cabal init</code> now takes an optional argument and treats it as root directory for the new package <a href="https://github.com/haskell/cabal/issues/7871">#7871</a> <a href="https://github.com/haskell/cabal/pull/7873">#7873</a></p></li>
<li><p>Silence warning about <code>world</code>-file field being unrecognised for flat config files <a href="https://github.com/haskell/cabal/issues/7894">#7894</a> <a href="https://github.com/haskell/cabal/pull/7903">#7903</a></p></li>
<li><p>Fix Ctrl-C handling during package download <a href="https://github.com/haskell/cabal/issues/6322">#6322</a> <a href="https://github.com/haskell/cabal/pull/7929">#7929</a></p></li>
<li><p>Fix the timestamp shown during <code>cabal update</code> <a href="https://github.com/haskell/cabal/pull/7934">#7934</a></p></li>
<li><p>Sync darcs repos <a href="https://github.com/haskell/cabal/pull/7137">#7137</a></p></li>
<li><p><code>cabal-install-solver</code>: Provide more context in error messages <a href="https://github.com/haskell/cabal/issues/7468">#7468</a> <a href="https://github.com/haskell/cabal/pull/7473">#7473</a></p>
<ul>
<li>Error messages for misspelled extensions and languages now provide additional context.</li>
<li>The error messages will provide a suggested fix if the misspelled extension or language is similar enough
to known languages and extensions.</li>
</ul></li>
<li><p>cabal init -i should autodetect author name and maintainer email (fix #8255) <a href="https://github.com/haskell/cabal/issues/8255">#8255</a> <a href="https://github.com/haskell/cabal/pull/8267">#8267</a></p></li>
<li><p>cabal init -i: add the GHC2021 language option <a href="https://github.com/haskell/cabal/issues/8265">#8265</a> <a href="https://github.com/haskell/cabal/pull/8277">#8277</a></p></li>
<li><p>Automatically pipe auth from repo uris into curl transport. <a href="https://github.com/haskell/cabal/issues/4743">#4743</a> <a href="https://github.com/haskell/cabal/pull/7630">#7630</a></p></li>
<li><p>Build release archives (and validate) with GHC 9.2.3 <a href="https://github.com/haskell/cabal/issues/8271">#8271</a> <a href="https://github.com/haskell/cabal/pull/8272">#8272</a></p>
<ul>
<li>The release binaries are now built with GHC 9.2.3, which fixes some minor snags</li>
</ul></li>
</ul>
<h3 id="internal-changes">Internal changes</h3>
<ul>
<li><p>Remove bootstrapping plan files from version control, and simplify bootstrap update <code>Makefile</code> targets. <a href="https://github.com/haskell/cabal/pull/7949">#7949</a></p></li>
<li><p>CI setup</p>
<ul>
<li>Remove Travis scripts <a href="https://github.com/haskell/cabal/pull/6959">#6959</a></li>
</ul></li>
</ul>
    </section>
</article>

                    <hr />
                    <footer>
                        <div class="row">
    <div class="col-6">
        <i class="fab fa-github"></i>
        <a href="https://github.com/haskell/cabal" target="_blank" rel="noopener">github/haskell/cabal</a>
    </div>
    <div class="col-6">
        <img style="position:relative;top:-2px" src="https://hackage.haskell.org/static/favicon.png" width="14px" height="14px" />
        <a href="https://hackage.haskell.org/" target="_blank" rel="noopener">hackage</a><br />
    </div>
</div>

                    </footer>
                </div>
            </div>
        </div>
    </div>
    <script>
        var switchColor = () => {
            if (document.documentElement.getAttribute('data-bs-theme') == 'dark') {
                document.getElementById('btn-switch-color-mode').innerHTML = 'light'
                document.getElementById('img-logo').setAttribute('src','/images/Cabal-dark.png')
            }
            else {
                document.getElementById('btn-switch-color-mode').innerHTML = 'dark'
                document.getElementById('img-logo').setAttribute('src','/images/Cabal-light.png')
            }
        };

        document.getElementById('btn-switch-color-mode').addEventListener('click',()=>{
            if (document.documentElement.getAttribute('data-bs-theme') == 'dark') {
                document.documentElement.setAttribute('data-bs-theme','light')
            }
            else {
                document.documentElement.setAttribute('data-bs-theme','dark')
            }

            switchColor();
        })

        switchColor();
    </script>
</body>

</html>
